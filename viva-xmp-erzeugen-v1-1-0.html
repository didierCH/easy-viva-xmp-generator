<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <!--[if lt IE 9]><script src="/static/script/html5shiv.js"></script><![endif]-->
    <style>
    * {box-sizing: border-box;}
    h1, h2, h3, p, label, input, select, button, option {font-family: arial, sans-serif;}
    h1 {font-size: 24px; margin-bottom: 0;}
    h2 {font-size: 19.2px; font-weight: normal;}
    h3 {font-size: 19.2px;}
    label {display: inline-block; width: 176px; padding: 3.2px 0px;}
    input {height: 22px; width: 293px; border: none; background-color: #3cbc8d; padding: 4px;}
    select {height: 22px; width: 293px; display: inline-block; border: none; background-color: #3cbc8d;}
    button {display: inline-block; border: none; background-color: #3cbc8d; padding: 4px;}
    option {padding: 4px;}
    pre {background-color: #d9d9d9; padding: 8px; min-height: 235px; width: 100%; margin: 0px;}
    span {font-weight: bold; color: red;}
    textarea {width: 100%; border-radius: 0px; border: 1px solid #000; margin: 32px 0px 16px 0px;}
    #wrapper {background-color: #f1f1f1; overflow: hidden; padding: 8px; width: 1100px;}
    #buttonFormularErstellen {float: right;}
    #xmlHead label {width: 172.8px;}
    #formWrapper {width: 472px; float: left; margin-right: 8px;}
    #xmlAusgabe {float: left; width: 600px;}
    #buttonXMPdateiErstellen {border: 2px solid #000; height: 30px; width: 200px; font-weight: bold; margin-top: 32px;}
    #version {font-size: 10.4px; float: right;}
    </style>
<head>
<body>
    <div id="wrapper">
    <h1>Easy Viva XMP-Generator</h1>
    <h2>Mit diesem Programm können Viva-XMP Daten für den Formularmodus des Printplus Druckportal erzeugt werden.</h2>
    <hr>
    <div id="formWrapper">
    <!-- <p>Geben Sie hier Ihre Informationen ein</p> -->
    <div id="headInfo">
    <form id="xmlHead">
    <h3>Head Informationen</h3>
        <label>viva:title: </label> <input type="text" id="inputVivaTitle" value=""><br>
        <label>viva:liste: </label>
            <select id="inputVivaListe">
                <option value="1">Liste anzeigen</option>
                <option value="2">Liste nicht anzeigen</option>
            </select><br>
        <label>viva:previewWidth: </label> <input type="text" id="inputVivaPreviewWidth" value="680"><br>
        <label>viva:previewHeight: </label> <input type="text" id="inputVivaPreviewHeight" value=""><br>
        <label>viva:formWidth: </label> <input type="text" id="inputVivaFormWidth" value="500"><br>
        <label>viva:productDescription: </label> <input type="text" id="inputVivaProductDescription" value="" placeholder="$Name.Vorname$ $Name.Name$"><br>
    </form>
    <hr>
    </div>
    <div id="formularfelder">
    </div>
    <div>
        <h3>Neues Formularfeld hinzufügen</h3>
        <select id="newValueSortOf">
            <option value="text">Textfeld</option>
            <option value="hidden">Verstecktes Feld</option>
            <option value="email">E-Mail Feld</option>
            <option value="textarea">Mehrzeiliges Formularfeld</option>
            <option value="select">Auswahlliste</option>
        </select>
        <button id="buttonFormularErstellen" onclick="neuesFormularfeld()">Formularfeld hinzufügen</button>
    </div>

    <br>
    <br>
    <button id="buttonXMPdateiErstellen" onclick="elementeAbrufen()">XMP-Datei erstellen</button>
    <br>
    <br>
    </div> <!-- end of form-wrapper -->

    <div id="xmlAusgabe">
    <!-- <p>Clipboard für CSV-File zur Vorlage</p> -->
    <textarea placeholder="Clipboard ..." rows="3"></textarea>
    <h3>XMP-Datei:</h3>
    <pre id="ausgabefeld"></pre>
    <p id="version">V.1.1.0<br>13.07.2016</p>
    </div> <!-- end of xmlAusgabe -->
    </div> <!-- end of wrapper -->

<script type="text/javascript">

// III
// choose which form field you want to create
function neuesFormularfeld() {
    valueNF = document.getElementById("newValueSortOf").value;

    switch (valueNF) {
        case "text":
            var formClassName = "text";
            var h3HeaderTitle = "Textfeld";
            var inputFields = ["name", "default", "label"];
            var setAttributName = ["name", "default", "label"];
            break;
        case "hidden":
            var formClassName = "hidden";
            var h3HeaderTitle = "Verstecktes Feld";
            var inputFields = ["name", "default"];
            break;
        case "email":
            var formClassName = "email";
            var h3HeaderTitle = "E-Mail-Feld";
            var inputFields = ["name", "default", "label", "align"];
            break;
        case "textarea":
            var formClassName = "textarea";
            var h3HeaderTitle = "Mehrzeiliges Formularfeld";
            var inputFields = ["name", "default", "textrows", "textchars", "label"];
            break;
        case "select":
            var formClassName = "select";
            var h3HeaderTitle = "Auswahlfeld";
            var inputFields = ["name", "title", "value", "title", "value", "label"];
            break;
        default:
            result = "text";
    }

    // create form-element
    var form = document.createElement("FORM");
        form.setAttribute("class", formClassName);

    // append new formelement with content to div formularfelder
    document.getElementById("formularfelder").appendChild(form);

    // create header element
    var header = document.createElement("h3");
        headerText = document.createTextNode(h3HeaderTitle);
        form.appendChild(header);
        header.appendChild(headerText);


    for (i = 0; i < inputFields.length; i++) {

    // create input field
        var inputLabel = document.createElement("label");
        var text = document.createTextNode("viva: " + inputFields[i]); // 1.
            form.appendChild(inputLabel);
            inputLabel.appendChild(text);

        var formName = document.createElement("input");
            formName.setAttribute("type", "text");
            formName.setAttribute("name", setAttributName[i]); // 2.
            formName.setAttribute("value", ""); // 3.
            formName.setAttribute("class", "inputElement vivaName"); // 4.
            form.appendChild(formName);

        var br = document.createElement("br");
            form.appendChild(br);

    }

    // append line after new created formelement
    var linie = document.createElement("hr");
    document.getElementById("formularfelder").appendChild(linie);
}

// IV
// Elemente abrufen

function elementeAbrufen() {
    var formAbrufen = document.getElementById("formularfelder").getElementsByTagName("form");
    var inputfieldText = "";
    var lz = "&#32;"

    // get head information
    var vivaTitle = document.getElementById("inputVivaTitle").value;
    var vivaListe = document.getElementById("inputVivaListe").value;
    var vivaPreviewWidth = document.getElementById("inputVivaPreviewWidth").value;
    var vivaPreviewHeight = document.getElementById("inputVivaPreviewHeight").value;
    var vivaFormWidth = document.getElementById("inputVivaFormWidth").value;
    var vivaProductDescription = document.getElementById("inputVivaProductDescription").value;

    // write head information
    var headText =
        "&lt;viva:form rdf:parseType=\"Resource\"&gt;<br>" +
        "&#32;&lt;viva:title&gt;<span>" + vivaTitle + "</span>&lt/viva:title&gt;<br>" +
        "&#32;&lt;viva:listeAnzeigen&gt;<span>" + vivaListe + "</span>&lt;/viva:listeAnzeigen&gt;<br>" +
        "&#32;&lt;viva:previewWidth&gt;<span>" + vivaPreviewWidth + "</span>&lt/viva:previewWidth&gt;<br>" +
        "&#32;&lt;viva:previewHeight&gt;<span>" + vivaPreviewHeight + "</span>&lt/viva:previewHeight&gt;<br>" +
        "&#32;&lt;viva:formWidth&gt;<span>" + vivaFormWidth + "</span>&lt/viva:formWidth&gt;<br>" +
        "&#32;&lt;viva:productDescription&gt;<span>" + vivaProductDescription + "</span>&lt/viva:productDescription&gt<br>" +
        "&#32;&#32;&#32;&lt;rdf:value rdf:parseType=\"Resource\"&gt;<br>" +
        "&#32;&#32;&#32;&#32;&lt;viva:fields&gt;<br>" +
        "&#32;&#32;&#32;&#32;&#32;&lt;rdf:Seq&gt;<br>";

    // write xml-closing information
    var closingText =
        "&#32;&#32;&#32;&#32;&#32;&lt;/rdf:Seq&gt;<br>" +
        "&#32;&#32;&#32;&#32;&lt;/viva:fields&gt;<br>" +
        "&#32;&#32;&#32;&lt;/rdf:value&gt;<br>" +
        "&lt;/viva:form&gt;";

    // loop through all user created form-fields
    for (i = 0; i < formAbrufen.length; i++) {
        var getClassName = formAbrufen[i].className;

        // decide which function to use determined through class name
        switch (getClassName) {
        case "text":
            createTextOutput();
            break;
        case "hidden":
            createHiddenOutput();
            break;
        case "email":
            createEmailOutput();
            break;
        case "textarea":
            createTextareaOutput();
            break;
        case "select":
            createSelectOutput();
            break;
        default:
            result = "Meine Form hat keine Klasse! <br>";
        }

        // create xml-output for textform
        function createTextOutput() {
            var getVivaName = formAbrufen[i].getElementsByTagName("input")[0].value;
            var getVivaDefault = formAbrufen[i].getElementsByTagName("input")[1].value;
            var getVivaLabel = formAbrufen[i].getElementsByTagName("input")[2].value;
            inputfieldText +=
                "&#32;&#32;&#32;&#32;&#32;&lt;rdf:li rdf:parseType=\"Resource\"&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:type&gt;<span>text</span>&lt;/viva:type&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:name&gt;<span>" + getVivaName + "</span>&lt;/viva:name&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:default&gt;<span>" + getVivaDefault + "</span>&lt;/viva:default&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:value rdf:parseType=\"Resource\"&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:label&gt;<span>" + getVivaLabel + "</span>&lt;/viva:label&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/rdf:value&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&lt;/rdf:li&gt;<br>";
        }

        // create xml-output for hiddenform
        function createHiddenOutput() {
            var getVivaName = formAbrufen[i].getElementsByTagName("input")[0].value;
            var getVivaDefault = formAbrufen[i].getElementsByTagName("input")[1].value;
            inputfieldText +=
                "&#32;&#32;&#32;&#32;&#32;&lt;rdf:li rdf:parseType=\"Resource\"&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:type&gt;<span>hidden</span>&lt;/viva:type&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:name&gt;<span>" + getVivaName + "</span>&lt;/viva:name&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:default&gt;<span>" + getVivaDefault + "</span>&lt;/viva:default&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&lt;/rdf:li&gt;<br>";
        }

        // create xml-output for emailform
        function createEmailOutput() {
            var getVivaName = formAbrufen[i].getElementsByTagName("input")[0].value;
            var getVivaDefault = formAbrufen[i].getElementsByTagName("input")[1].value;
            // var getVivaPattern = formAbrufen[i].getElementsByTagName("input")[2].value;
            var getVivaLabel = formAbrufen[i].getElementsByTagName("input")[2].value;
            // var getVivaHelp = formAbrufen[i].getElementsByTagName("input")[4].value;
            var getVivaAlign = formAbrufen[i].getElementsByTagName("input")[3].value;
            inputfieldText +=
                "&#32;&#32;&#32;&#32;&#32;&lt;rdf:li rdf:parseType=\"Resource\"&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:type&gt;<span>email</span>&lt;/viva:type&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:name&gt;<span>" + getVivaName + "</span>&lt;/viva:name&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:default&gt;<span>" + getVivaDefault + "</span>&lt;/viva:default&gt;<br>" +
                // "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:pattern&gt;<span>" + getVivaPattern + "</span>&lt;/viva:pattern&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:value rdf:parseType=\"Resource\"&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:label&gt;<span>" + getVivaLabel + "</span>&lt;/viva:label&gt;<br>" +
                // "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:help&gt;<span>" + getVivaHelp + "</span>&lt;/viva:help&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:align&gt;<span>" + getVivaAlign + "</span>&lt;/viva:align&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/rdf:value&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&lt;/rdf:li&gt;<br>";
        }

        // create xml-output for textareaform
        function createTextareaOutput() {
            var getVivaName = formAbrufen[i].getElementsByTagName("input")[0].value;
            var getVivaDefault = formAbrufen[i].getElementsByTagName("input")[1].value;
            var getVivaTextrows = formAbrufen[i].getElementsByTagName("input")[2].value;
            var getVivaTextchars = formAbrufen[i].getElementsByTagName("input")[3].value;
            var getVivaLabel = formAbrufen[i].getElementsByTagName("input")[4].value;
            // var getVivaDescription = formAbrufen[i].getElementsByTagName("input")[5].value;
            // var getVivaHelp = formAbrufen[i].getElementsByTagName("input")[6].value;
            inputfieldText +=
                "&#32;&#32;&#32;&#32;&#32;&lt;rdf:li rdf:parseType=\"Resource\"&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:type&gt;<span>textarea</span>&lt;/viva:type&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:name&gt;<span>" + getVivaName + "</span>&lt;/viva:name&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:default&gt;<span>" + getVivaDefault + "</span>&lt;/viva:default&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:textrows&gt;<span>" + getVivaTextrows + "</span>&lt;/viva:textrows&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:textchars&gt;<span>" + getVivaTextchars + "</span>&lt;/viva:textchars&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:value rdf:parseType=\"Resource\"&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:label&gt;<span>" + getVivaLabel + "</span>&lt;/viva:label&gt;<br>" +
                // "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:description&gt;<span>" + getVivaDescription + "</span>&lt;/viva:description&gt;<br>" +
                // "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:help&gt;<span>" + getVivaHelp + "</span>&lt;/viva:help&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/rdf:value&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&lt;/rdf:li&gt;<br>";
        }

        // create xml-output for selectform
        function createSelectOutput() {
            var getVivaName = formAbrufen[i].getElementsByTagName("input")[0].value;
            var getVivaTitle01 = formAbrufen[i].getElementsByTagName("input")[1].value;
            var getVivaValue01 = formAbrufen[i].getElementsByTagName("input")[2].value;
            var getVivaTitle02 = formAbrufen[i].getElementsByTagName("input")[3].value;
            var getVivaValue02 = formAbrufen[i].getElementsByTagName("input")[4].value;
            var getVivaLabel = formAbrufen[i].getElementsByTagName("input")[5].value;
            inputfieldText +=
                "&#32;&#32;&#32;&#32;&#32;&lt;rdf:li rdf:parseType=\"Resource\"&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:type&gt;<span>select</span>&lt;/viva:type&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:name&gt;<span>" + getVivaName + "</span>&lt;/viva:name&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:value rdf:parseType=\"Resource\"&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:options&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:Seq&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:li rdf:parseType=\"Resource\"&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:title&gt<span>" + getVivaTitle01 + "</span>&lt;/viva:title&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:value&gt<span>" + getVivaValue01 + "</span>&lt;/rdf:value&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/rdf:li&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:li rdf:parseType=\"Resource\"&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:title&gt<span>" + getVivaTitle02 + "</span>&lt;/viva:title&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;rdf:value&gt<span>" + getVivaValue02 + "</span>&lt;/rdf:value&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/rdf:li&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/rdf:Seq&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/viva:options&gt<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;viva:label&gt;<span>" + getVivaLabel + "</span>&lt;/viva:label&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&#32;&#32;&lt;/rdf:value&gt;<br>" +
                "&#32;&#32;&#32;&#32;&#32;&lt;/rdf:li&gt;<br>";
        }
    }

    document.getElementById("ausgabefeld").innerHTML = headText + inputfieldText + closingText;
}


</script>



</body></html>
